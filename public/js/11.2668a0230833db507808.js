webpackJsonp([11],{"4qB1":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("SxQf"),a=s.n(n);for(var i in n)"default"!==i&&function(t){s.d(e,t,function(){return n[t]})}(i);var r=s("pMWi"),u=s("VU/8")(a.a,r.a,!1,null,null,null);e.default=u.exports},SxQf:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=l(s("Dd8w")),a=s("NYxO"),i=l(s("mtWM")),r=l(s("I3G/")),u=l(s("e7x4"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={metaInfo:{title:"Teams",titleTemplate:null},computed:(0,n.default)({},(0,a.mapGetters)({user:"auth/user",authenticated:"auth/check"})),mounted:function(){if(this.authenticated&&null!=this.user.institution_id){this.getVueItems(),this.getGames(),this.getCountries();var t=this;r.default.nextTick(function(){function e(t){if(!t.id)return t.text;var e=$(t.element).data("image");return e?$('<span><img src="/images/flags/'+e+'" width="23px" /> '+t.text+"</span>"):t.text}$("#game_list").select2({placeholder:"Select game",allowClear:!0}).on("select2:select",function(e){t.game_id=$(e.currentTarget).find("option:selected").val(),t.search()}).on("select2:unselecting",function(e){t.game_id="",""!=t.country_id?t.$router.push(t.$route.path+"?users_country_id="+t.country_id):t.$router.push(t.$route.path)}),$("#country_list").select2({placeholder:"Select country",templateResult:e,templateSelection:e,allowClear:!0}).on("select2:select",function(e){t.country_id=$(e.currentTarget).find("option:selected").val(),t.search()}).on("select2:unselecting",function(e){t.country_id="",""!=t.game_id?t.$router.push(t.$route.path+"?game_id="+t.game_id):t.$router.push(t.$route.path)})})}},data:function(){return{teams:[],games:[],countries:[],queryString:"",pagination:[],statuses:[{id:"",title:""},{id:0,title:"pending"},{id:1,title:"accepted"}],game_id:this.$route.query.game_id||"",country_id:this.$route.query.users_country_id||""}},methods:{getVueItems:function(){var t=this,e={page:1,_limit:12,_with:"game,fights,users",_sort:"-id"};this.authenticated&&"investor"!=this.user.type&&(e.game_id=this.user.game_id,null!==this.user.institution_id&&(e.institution_id=this.user.institution_id),e["institution_id-not"]="null");var s=this.UrlParamsMerge(e);i.default.get("/api/teams?"+s).then(function(e){t.$set(t,"teams",e.data.data),delete e.data.data,t.pagination=e.data})},getGames:function(){var t=this;i.default.get("/api/games").then(function(e){t.$set(t,"games",e.data),t.$parent.games=t.games})},getCountries:function(){var t=this;i.default.get("/api/countries").then(function(e){t.$set(t,"countries",e.data)})},search:function(t){this.$router.push(this.$route.path+"?"+$("#filter-form").serialize())},joinTeam:function(t){var e=this;i.default.put("/api/teams/"+t+"/users/"+this.user.id).then(function(t){(0,u.default)({type:"success",title:e.$t("join_team_request_success")})}).catch(function(t){(0,u.default)({type:"warning",title:t.response.data.error})})}},watch:{"$route.query":function(t,e){this.getVueItems()}}}},pMWi:function(t,e,s){"use strict";var n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.authenticated?s("card",{attrs:{title:t.$t("teams")}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},[null===t.user.institution_id?[s("p",{staticClass:"text-white"},[t._v("\n\t\t\t\t\t\t\tДля просмотра команд вы должны \n\t\t\t\t\t\t\t"),s("router-link",{staticClass:"nk-btn nk-btn-rounded nk-btn-color-main-1 text-white f07em",attrs:{to:{name:"settings.school"}}},[t._v("\n\t\t\t\t\t\t\t\tзадать школу \n\t\t\t\t\t\t\t")]),t._v(" в личном кабинете.\n\t\t\t\t\t\t")],1)]:t._e(),t._v(" "),null!=t.user.institution_id&&0==t.teams.length?[s("p",{staticClass:"text-white"},[t._v("\n\t\t\t\t\t\t\tВ вашей школе еще нет ни одной команды. Будьте первым,  \n\t\t\t\t\t\t\t"),s("router-link",{staticClass:"nk-btn nk-btn-rounded nk-btn-color-main-1 text-white f07em",attrs:{to:{name:"settings.team"}}},[t._v("\n\t\t\t\t\t\t\tсоздайте\n\t\t\t\t\t\t\t")]),t._v(" команду.\n\t\t\t\t\t\t")],1)]:t._e(),t._v(" "),null!==t.teams&&t.teams.length>0?s("table",{staticClass:"nk-table"},[s("tbody",[s("tr",[s("th",[t._v(t._s(t.$t("title")))]),t._v(" "),s("th",[t._v(t._s(t.$t("players")))]),t._v(" "),s("th",[t._v(t._s(t.$t("game")))]),t._v(" "),s("th",[t._v(t._s(t.$t("count_matches")))]),t._v(" "),s("th",[t._v(t._s(t.$t("count_wins")))]),t._v(" "),s("th",[t._v(t._s(t.$t("victory_rate")))]),t._v(" "),s("th",[t._v(t._s(t.$t("status")))])]),t._v(" "),t._l(t.teams,function(e){return s("tr",[s("td",[s("router-link",{staticClass:"vm-title",attrs:{to:{name:"team",params:{id:e.id}}}},[s("img",{staticClass:"w-50px mr-10",attrs:{src:t.getImageLink(e.image,"avatar_team"),alt:e.title}}),t._v(" "),s("span",[t._v(t._s(e.title))])])],1),t._v(" "),s("td",{staticClass:"text-center"},[s("router-link",{attrs:{to:{name:"team.detail.players",params:{slug:e.slug}}}},[t._v(t._s(e.users.length))]),t._v(" / "+t._s(e.quantity))],1),t._v(" "),null!==e.game?s("td",{staticClass:"text-center"},[s("router-link",{attrs:{to:{name:"game",params:{gameId:e.game.id}},title:e.game.title}},[s("img",{attrs:{src:t.getImageLink(e.game.logo_mini),width:"35",alt:e.game.title}})])],1):s("td",{staticClass:"text-center"}),t._v(" "),s("td",{staticClass:"text-center"},[t._v(t._s(e.count_fights))]),t._v(" "),s("td",{staticClass:"text-center"},[t._v(t._s(e.count_wins))]),t._v(" "),e.count_fights>0?s("td",{staticClass:"text-center"},[t._v(t._s(Number((e.count_wins/e.count_fights*100).toFixed(2)))+"%")]):s("td",{staticClass:"text-center"},[t._v("0%")]),t._v(" "),s("td",{staticClass:"text-center"},[0==e.status?s("span",[s("span",{staticClass:"text-warning"},[t._v(t._s(t.$t("status_pending")))])]):t._e(),t._v(" "),1==e.status?s("span",[s("span",{staticClass:"text-success"},[t._v(t._s(t.$t("status_accepted")))])]):t._e(),t._v(" "),e.quantity>e.users.length&&t.authenticated&&t.user.id!==e.capt_id&&"player"==t.user.type&&t.user.active?s("button",{staticClass:"nk-btn nk-btn-rounded nk-btn-color-main-1 text-white",on:{click:function(s){t.joinTeam(e.id)}}},[t._v("\n                                    "+t._s(t.$t("join_team"))+"\n                                ")]):t._e()])])})],2)]):t._e(),t._v(" "),s("pagination",{attrs:{pagination:t.pagination}})],2)])]):s("card",{attrs:{title:t.$t("teams")}},[s("p",{staticClass:"text-white"},[t._v("\n                Для того чтобы увидеть список команд, "),s("router-link",{staticClass:"nk-btn nk-btn-rounded nk-btn-color-main-1 text-white f07em",attrs:{to:{name:"register"}}},[t._v("\n                зарегистрируйтесь")]),t._v(" или "),s("router-link",{staticClass:"nk-btn nk-btn-rounded nk-btn-color-main-1 text-white f07em",attrs:{to:{name:"login"}}},[t._v("авторизуйтесь")]),t._v(", если у вас есть аккаунт.\n            ")],1)])],1)},staticRenderFns:[]};e.a=n}});
//# sourceMappingURL=11.2668a0230833db507808.js.map