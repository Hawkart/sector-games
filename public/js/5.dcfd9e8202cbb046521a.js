webpackJsonp([5],{"10H0":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=l(e("Dd8w")),n=e("NYxO"),i=l(e("mtWM")),r=(l(e("e7x4")),e("HNcv")),o=l(e("I3G/"));function l(t){return t&&t.__esModule?t:{default:t}}a.default={props:["filter"],computed:(0,s.default)({},(0,n.mapGetters)({user:"auth/user",authenticated:"auth/check",locale:"lang/locale"})),data:function(){return{fights:[],status_list:[{id:0,title:"Все"},{id:1,title:"Прошедшие"},{id:2,title:"Онлайн"},{id:3,title:"Предстоящие"}],status_id:null,pagination:[]}},mounted:function(){(0,r.loadMessages)(this.locale),this.moment.locale(this.locale),this.getFights();var t=this;o.default.nextTick(function(){$("#status_list").select2({placeholder:"Статус матча"}).on("change",function(a){t.status_id=$(a.currentTarget).find("option:selected").val()})})},methods:{getFights:function(){var t=this,a={page:1,_limit:12,_sort:"start_at",_with:"invitations.team,invitations.team.institution,invitations.team.institution.location,winner,game"};if(null!==this.filter)for(var e in this.filter)this.filter.hasOwnProperty(e)&&(a[e]=this.filter[e]);if(this.authenticated&&1!=this.user.role_id){var s="/api/teams/"+this.user.team_id+"/fights";"referee"==this.user.type&&(a.judge_id=this.user.id,s="/api/fights")}else s="/api/fights";1==this.status_id?a["winner_id-gt"]=0:2==this.status_id?(a.winner_id=null,a["start_at-st"]=this.moment.utc().format()):3==this.status_id&&(a["start_at-gt"]=this.moment.utc().format());var n=this.UrlParamsMerge(a);i.default.get(s+"?"+n).then(function(a){var e=a.data.data,s=t;e.forEach(function(t){t.start_at=s.dateConvertUTC(t.start_at,-1)}),t.$set(t,"fights",e),delete a.data.data,t.pagination=a.data})},checkUpcoming:function(t){var a=new Date(t),e=new Date;return a.getTime()-e.getTime()>0}},watch:{"$route.query":function(t,a){this.getFights()},status_id:function(t,a){this.getFights()}}}},C0Yk:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("10H0"),n=e.n(s);for(var i in s)"default"!==i&&function(t){e.d(a,t,function(){return s[t]})}(i);var r=e("XujU"),o=e("VU/8")(n.a,r.a,!1,null,null,null);a.default=o.exports},Cv1l:function(t,a,e){"use strict";var s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[null!=t.tournament?e("card",{attrs:{title:t.tournament.title}},[e("div",{staticClass:"nk-tabs"},[e("ul",{staticClass:"nav nav-tabs",attrs:{role:"tablist"}},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{href:"#tabs-1-1",role:"tab","data-toggle":"tab"}},[t._v("Инфо")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#tabs-1-2",role:"tab","data-toggle":"tab"}},[t._v("Команды")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#tabs-1-3",role:"tab","data-toggle":"tab"}},[t._v("Матчи")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#tabs-1-4",role:"tab","data-toggle":"tab"}},[t._v("Сетка")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#tabs-1-5",role:"tab","data-toggle":"tab"}},[t._v("Призы")])])]),t._v(" "),e("div",{staticClass:"tab-content"},[e("div",{staticClass:"tab-pane fade show active",attrs:{role:"tabpanel",id:"tabs-1-1"}},[e("div",{staticClass:"nk-gap"}),t._v(" "),e("div",{staticClass:"nk-gap"})]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{role:"tabpanel",id:"tabs-1-2"}},[e("div",{staticClass:"nk-gap"}),t._v(" "),null!=t.tournament&&null!==t.tournament.teams&&t.tournament.teams.length>0?e("table",{staticClass:"nk-table"},[e("tbody",[e("tr",[e("th",[t._v(t._s(t.$t("title")))]),t._v(" "),e("th",[t._v(t._s(t.$t("region")))]),t._v(" "),e("th",[t._v(t._s(t.$t("players")))]),t._v(" "),e("th",[t._v(t._s(t.$t("game")))]),t._v(" "),e("th",[t._v(t._s(t.$t("count_matches")))]),t._v(" "),e("th",[t._v(t._s(t.$t("count_wins")))]),t._v(" "),e("th",[t._v(t._s(t.$t("victory_rate")))])]),t._v(" "),t._l(t.tournament.teams,function(a){return e("tr",[e("td",[e("router-link",{staticClass:"vm-title",attrs:{to:{name:"team",params:{id:a.id}}}},[e("img",{staticClass:"w-50px mr-10",attrs:{src:t.getImageLink(a.image,"avatar_team"),alt:a.title}}),t._v(" "),e("span",[t._v(t._s(a.title))])])],1),t._v(" "),e("td",[a.institution_id>0?[t._v("\n                                    "+t._s(a.institution.location.parent.title)+",\n                                    "+t._s(a.institution.location.title)+"\n                                ")]:t._e()],2),t._v(" "),e("td",{staticClass:"text-center"},[e("router-link",{attrs:{to:{name:"team.detail.players",params:{slug:a.slug}}}},[t._v(t._s(a.users.length))]),t._v(" / "+t._s(a.quantity))],1),t._v(" "),null!==a.game?e("td",{staticClass:"text-center"},[e("router-link",{attrs:{to:{name:"game",params:{gameId:t.tournament.game.id}},title:t.tournament.game.title}},[e("img",{attrs:{src:t.getImageLink(t.tournament.game.logo_mini),width:"35",alt:t.tournament.game.title}})])],1):e("td",{staticClass:"text-center"}),t._v(" "),e("td",{staticClass:"text-center"},[t._v(t._s(a.count_fights))]),t._v(" "),e("td",{staticClass:"text-center"},[t._v(t._s(a.count_wins))]),t._v(" "),a.count_fights>0?e("td",{staticClass:"text-center"},[t._v(t._s(Number((a.count_wins/a.count_fights*100).toFixed(2)))+"%")]):e("td",{staticClass:"text-center"},[t._v("0%")])])})],2)]):t._e(),t._v(" "),e("pagination",{attrs:{pagination:t.pagination}}),t._v(" "),e("div",{staticClass:"nk-gap"})],1),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{role:"tabpanel",id:"tabs-1-3"}},[e("div",{staticClass:"nk-gap"}),t._v(" "),e("match-list",{attrs:{filter:t.match_filter}}),t._v(" "),e("div",{staticClass:"nk-gap"})],1),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{role:"tabpanel",id:"tabs-1-4"}},[e("div",{staticClass:"nk-gap"}),t._v(" "),e("div",{staticClass:"nk-gap"})]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{role:"tabpanel",id:"tabs-1-5"}},[e("div",{staticClass:"nk-gap"}),t._v(" "),e("div",{staticClass:"nk-gap"})])])])]):t._e()],1)},staticRenderFns:[]};a.a=s},XujU:function(t,a,e){"use strict";var s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("card",[e("div",{staticClass:"form-wrap"},[e("form",{attrs:{autocomplete:"off",id:"filter-form"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.status_id,expression:"status_id"}],staticClass:"form-control",attrs:{name:"status_id","data-style":"form-control btn-default btn-outline",id:"status_list"},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.status_id=a.target.multiple?e:e[0]}}},t._l(t.status_list,function(a){return e("option",{domProps:{value:a.id}},[t._v("\n                                            "+t._s(a.title)+"\n                                        ")])}))])])])])])],1)]),t._v(" "),e("div",{staticClass:"nk-gap-2"})],t._v(" "),null!=t.fights&&t.fights.length>0?e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},[t._l(t.fights,function(a){return e("div",{staticClass:"nk-match"},[e("div",{staticClass:"nk-match-team-left"},[e("router-link",{attrs:{to:{name:"team",params:{id:a.invitations[0].team.id}}}},[e("span",{staticClass:"nk-match-team-logo"},[e("img",{staticClass:"w-64px mr-10",attrs:{src:t.getImageLink(a.invitations[0].team.image,"avatar_team")}})]),t._v(" "),e("span",{staticClass:"nk-match-team-name"},[t._v("\n                            "+t._s(a.invitations[0].team.institution.title)+", "+t._s(a.invitations[0].team.institution.location.title)+","),e("br"),t._v("\n                            "+t._s(a.invitations[0].team.title)+"\n                        ")])])],1),t._v(" "),e("div",{staticClass:"nk-match-status"},[e("router-link",{attrs:{to:{name:"match",params:{id:a.id}}}},[e("span",{staticClass:"nk-match-status-vs"},[t._v("VS (bo3)")]),t._v(" "),e("span",{staticClass:"nk-match-status-date"},[t._v(t._s(t.moment.utc(a.start_at,"YYYY-MM-DD h:mm:ss").format("MMMM Do, HH:mm"))+" МСК")]),t._v(" "),e("span",{staticClass:"nk-match-score"},[t.checkUpcoming(a.start_at)?[t._v(t._s(t.$t("upcoming")))]:a.winner_id>0?[parseInt(a.result[0])>parseInt(a.result[1])&&a.invitations[0].team.id==a.winner_id?[t._v("\n                                    "+t._s(a.result[0])+" : "+t._s(a.result[1])+"\n                                ")]:parseInt(a.result[1])>parseInt(a.result[0])&&a.invitations[1].team.id==a.winner_id?[t._v("\n                                    "+t._s(a.result[0])+" : "+t._s(a.result[1])+"\n                                ")]:[t._v("\n                                    "+t._s(a.result[1])+" : "+t._s(a.result[0])+"\n                                ")]]:[t._v(t._s(t.$t("online")))]],2)])],1),t._v(" "),e("div",{staticClass:"nk-match-team-right"},[e("router-link",{attrs:{to:{name:"team",params:{id:a.invitations[1].team.id}}}},[e("span",{staticClass:"nk-match-team-name"},[t._v("\n                            "+t._s(a.invitations[1].team.institution.title)+", "+t._s(a.invitations[1].team.institution.location.title)+","),e("br"),t._v("\n                            "+t._s(a.invitations[1].team.title)+"\n                        ")]),t._v(" "),e("span",{staticClass:"nk-match-team-logo"},[e("img",{staticClass:"w-64px ml-10",attrs:{src:t.getImageLink(a.invitations[1].team.image,"avatar_team")}})])])],1)])}),t._v(" "),e("pagination",{attrs:{pagination:t.pagination}})],2)]):e("div",[e("p",{staticClass:"txt-danger"},[t._v(t._s(t.$t("no_results")))])])],2)},staticRenderFns:[]};a.a=s},m5O0:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("nxqK"),n=e.n(s);for(var i in s)"default"!==i&&function(t){e.d(a,t,function(){return s[t]})}(i);var r=e("Cv1l"),o=e("VU/8")(n.a,r.a,!1,null,null,null);a.default=o.exports},nxqK:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=c(e("Xxa5")),n=c(e("exGp")),i=c(e("Dd8w")),r=e("NYxO"),o=c(e("mtWM")),l=c(e("e7x4")),u=(e("HNcv"),c(e("I3G/")),c(e("C0Yk")));function c(t){return t&&t.__esModule?t:{default:t}}a.default={components:{MatchList:u.default},metaInfo:function(){return{title:this.title}},computed:(0,i.default)({},(0,r.mapGetters)({user:"auth/user",authenticated:"auth/check",locale:"lang/locale"}),{teamsInTournament:function(){var t=[];return void 0!=this.tournament.teams&&this.tournament.teams.length>0&&this.tournament.teams.forEach(function(a){t.push(a.id)}),t}}),mounted:function(){this.getTournament()},data:function(){return{title:"Detail tournament",tournament:null,fights:null,status_list:[{id:0,title:"Все"},{id:1,title:"Прошедшие"},{id:2,title:"Онлайн"},{id:3,title:"Предстоящие"}],match_filter:{tournament_id:this.$route.params.id},status_id:null,success:!1,error:!1,response:null}},methods:{getTournament:function(){var t=this;return(0,n.default)(s.default.mark(function a(){var e,n,i,r,l;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=t.ArrayToUrl({_with:"game,fights,fights.invitations.team,fights.winner"}),a.prev=1,a.next=4,o.default.get("/api/tournaments/"+t.$route.params.id+"?"+e);case 4:n=a.sent,t.$set(t,"tournament",n.data),t.tournament.start_at=t.dateConvertUTC(t.tournament.start_at,-1),t.tournament.register_start=t.dateConvertUTC(t.tournament.register_start,-1),i=t.tournament.winners_part.split(","),r=parseInt(t.tournament.prize_pool),l=[],i.forEach(function(t){l.push(parseInt(t)*r/100)}),t.tournament.prizes=l,t.title=t.tournament.title,t.$meta().refresh(),t.getTournamentTeams(),t.getTournamentBrackets(),t.getTournamentMatches(),a.next=23;break;case 20:a.prev=20,a.t0=a.catch(1),t.errors.push(a.t0);case 23:case"end":return a.stop()}},a,t,[[1,20]])}))()},getTournamentTeams:function(){var t=this;return(0,n.default)(s.default.mark(function a(){var e,n;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=t.ArrayToUrl({_with:"fights,users,institution.location,institution.location.parent"}),a.next=4,o.default.get("/api/tournaments/"+t.$route.params.id+"/teams?"+e);case 4:n=a.sent,t.$set(t.tournament,"teams",n.data),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),t.errors.push(a.t0);case 11:case"end":return a.stop()}},a,t,[[0,8]])}))()},getTournamentMatches:function(){var t=this;return(0,n.default)(s.default.mark(function a(){var e,n,i,r,l,u;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e={tournament_id:t.tournament.id,page:1,_limit:12,_sort:"start_at",_with:"invitations.team,invitations.team.institution,invitations.team.institution.location,winner,game"},t.authenticated&&1!=t.user.role_id?(n="/api/teams/"+t.user.team_id+"/fights","referee"==t.user.type&&(e.judge_id=t.user.id,n="/api/fights")):n="/api/fights",1==t.status_id?e["winner_id-gt"]=0:2==t.status_id?(e.winner_id=null,e["start_at-st"]=t.moment.utc().format()):3==t.status_id&&(e["start_at-gt"]=t.moment.utc().format()),i=t.UrlParamsMerge(e),a.next=7,o.default.get(n+"?"+i);case 7:r=a.sent,l=r.data.data,u=t,l.forEach(function(t){t.start_at=u.dateConvertUTC(t.start_at,-1)}),t.$set(t,"fights",l),delete r.data.data,t.pagination=r.data,a.next=19;break;case 16:a.prev=16,a.t0=a.catch(0),t.errors.push(a.t0);case 19:case"end":return a.stop()}},a,t,[[0,16]])}))()},getTournamentBrackets:function(){var t=this;return(0,n.default)(s.default.mark(function a(){var e;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o.default.get("/api/tournaments/"+t.$route.params.id+"/brackets");case 3:e=a.sent,t.$set(t.tournament,"brackets",e.data),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),t.errors.push(a.t0);case 10:case"end":return a.stop()}},a,t,[[0,7]])}))()},register:function(){var t=this;this.authenticated?null!=this.user.team_id?o.default.post("/api/tournaments/"+this.$route.params.id+"/teams/"+this.user.team_id).then(function(a){(0,l.default)({type:"success",title:"Success!",html:"You are registered on the tournament!"}),t.getTournamentTeams()}).catch(function(t){(0,l.default)({type:"warning",title:"Error!",html:t.response.data.error})}):(0,l.default)({type:"warning",title:"Error!",html:"You need to be in the team."}):this.$router.push({name:"login"})},checkRigisterStart:function(){return this.moment.utc().isAfter(this.tournament.register_start)},checkRigisterEnd:function(){return this.moment.utc().isBefore(this.moment(this.tournament.start_at).subtract(1,"hours"))},checkRegistered:function(t){return this.teamsInTournament.indexOf(t)>-1},checkUpcoming:function(t){var a=new Date(t),e=new Date;return a.getTime()-e.getTime()>0}}}}});
//# sourceMappingURL=5.dcfd9e8202cbb046521a.js.map